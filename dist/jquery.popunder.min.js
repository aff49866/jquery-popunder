/*! jquery-plugin to create popunders in major browsers., 0.2.63 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2018 Hans-Peter Buniat, BSD-3-Clause license */

!function(t,e,n,i,r){"use strict";t.popunder=function(n,i,r,o){var s=t.popunder.helper;if(s.init(),typeof Cookies!==s.u&&(s.c=Cookies.noConflict()),0===arguments.length?n=e.aPopunder:typeof n!==s.fu&&t(n).is("a")&&(o=t.Event("click",{target:n}),n=e.aPopunder),r||i)s.bindEvents(n,i,r);else if(n=typeof n===s.fu?n(o):n,s.reset(),typeof n!==s.u){do{s.queue(n,o),s.first=!1}while(n.length>0);s.queue(n,o)}return t},t.popunder.helper={POP:"pop",SWITCHER:"switcher",SIMPLE:"simple",_top:e.self,lastWin:null,lastTarget:null,f:!1,last:!1,first:!0,b:"about:blank",u:"undefined",fu:"function",o:null,c:null,du:"__jqpu",ua:{ie:/msie|trident/i.test(i.userAgent),oldIE:/msie/i.test(i.userAgent),edge:/edge/i.test(i.userAgent),ff:/firefox/i.test(i.userAgent),o:/opera/i.test(i.userAgent),g:/chrome/i.test(i.userAgent),w:/webkit/i.test(i.userAgent),linux:/linux/i.test(i.userAgent),touch:"ontouchstart"in r.documentElement||/bada|blackberry|iemobile|android|iphone|ipod|ipad/i.test(i.userAgent)},m:!1,hs:[],ns:"jqpu",donate:!0,def:{window:{toolbar:0,scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,width:(n.availWidth-122).toString(),height:(n.availHeight-122).toString(),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,skip:{},cb:null,popup:!1},testStack:function(t,e){var n,i=!1;for(n in t)t.hasOwnProperty(n)&&t[n]&&e[n]&&(i=t[n]);return i},init:function(){var t=this;return t.m||(t.m=t.testStack({ff:t.POP,ie:t.SWITCHER,edge:t.SWITCHER,w:t.SWITCHER,g:t.SWITCHER,o:t.SWITCHER,linux:t.SWITCHER,touch:t.SWITCHER},t.ua)),t},queue:function(t,e){var n=!1,i=this;if(t.length>0)for(;!1===n;){var r=t.shift();n=!r||i.open(r[0],r[1]||{},t.length,e)}else!1===i.last?(i.last=!0,i.bg().href(!0)):i.f||i.m!==i.POP||i.bg();return i},handler:function(t,e){var n=this;typeof n.hs[t]===n.fu&&n.hs[t](e)},getTrigger:function(e){return t("#"+e).parents(".jq-pu").children().eq(0)},bindEvents:function(e,n,i){var r=this,o="string",s=r.ua.touch?"touchstart click":"click",u=r.hs.length,a=function(t){return function(e){r.handler(t,e)}}(u);return r.hs[u]=function(e){return function(n){return n&&!n.target&&(n={target:r.getTrigger(n)}),t.popunder(e,!1,!1,n),!0}}(e),!n||r.ua.g||r.ua.w||r.ua.touch||(n=typeof n===o?t(n):n).on("submit."+r.ns,a),i&&(i=typeof i===o?t(i):i).on(s+"."+r.ns,a),r},cookieCheck:function(t,e){var n=this,i=n.rand(e.cookie,!1),r=n.c.get(i),o=!1;return r?-1===r.indexOf(t)?r+=t:o=!0:r=t,n.c.set(i,r,{expires:new Date((new Date).getTime()+6e4*e.blocktime)}),o},rand:function(t,e){var n=this;return(t||n.du)+(!1===e?"":Math.floor(89999999*Math.random()+1e7).toString()).replace(".","")},open:function(n,i,r,o){var s,u=this,a=t.extend(!0,{},u.def,i);if(u.o=n,top!==e.self)try{top.document.location.toString()&&(u._top=top)}catch(t){}return!u.testStack(a.skip,u.ua)&&((!a.blocktime||typeof u.c!==u.fu||!u.cookieCheck(n,a))&&(n!==u.du&&(u.lastTarget=n,!0===u.first&&u.m===u.SWITCHER?(o&&typeof o.target!==this.u&&(s=u.getElementUrl(o),o.preventDefault()),u.switcher.switchWindow(s,u.o,u.rand(a.name,!i.name))):!0!==u.first&&!0!==u.isMultiple()||(u.lastWin=u._top.window.open(u.o,u.rand(a.name,!i.name),u.getOptions(a.window))||u.lastWin),!0===u.ua.ff&&u.bg(),u.href(r),typeof a.cb===u.fu&&a.cb(u.lastWin)),!0))},bg:function(t){var n=this;return n.lastWin&&n.lastTarget&&!t?n.m===n.SIMPLE?(n.switcher.simple(n),e.setTimeout(function(){n.switcher.simple(n)},500)):n.switcher.pop(n):"oc"===t&&n.switcher.pop(n),n},switcher:{simple:function(t){t.ua.oldIE?(t.lastWin.blur(),t.lastWin.opener.window.focus(),e.self.window.focus(),e.focus()):r.focus()},pop:function(t){!function(e){try{t.f=e.window.open(t.b),t.f&&t.f.close()}catch(t){}try{e.opener.window.focus()}catch(t){}}(t.lastWin)},switchWindow:function(t,n,i){e.open(t,i),e.location.assign(n)}},isMultiple:function(){var t=this;return t.m===t.POP||t.m===t.simple},href:function(t){var e=this;return t&&e.lastTarget&&e.lastWin&&e.lastTarget!==e.b&&e.lastTarget!==e.o&&(e.lastWin.document.location.href=e.lastTarget),e},getElementUrl:function(e,n){var i,r,o=this,s=":submit, button",u=t(e.target),a=typeof n===o.u;return u.is("a")&&a?(i=u,r=u.attr("href")):!0!==u.is(s)?i=(u=u.parents(s)).parents("form"):(i=t(e.target.form),!u.is(s)||i&&i.length||(i=u.parents("form"))),r||0===u.length||0===i.length||"get"!==(i.prop("method")+"").toLowerCase()||"_blank"!==i.attr("target")&&!a||(r=i.attr("action")+"/?"+i.serialize()),r},reset:function(){var t=this;return t.f=t.last=!1,t.first=!0,t.lastTarget=t.lastWin=null,t},unbind:function(n,i){var r=this,o="string";return r.reset(),n&&(n=typeof n===o?t(n):n).off("submit."+r.ns),i&&((i=typeof i===o?t(i):i).off("click."+r.ns).next(".jq-pu object").remove(),i.unwrap()),e.aPopunder=[],r},getOptions:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return n.join(",")}}}(jQuery,window,screen,navigator,document);